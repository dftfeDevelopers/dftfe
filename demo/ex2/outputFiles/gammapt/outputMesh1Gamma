==========================================================================================================
==========================================================================================================
			Welcome to the Open Source program DFT-FE development version			        
This is a C++ code for materials modeling from first principles using Kohn-Sham density functional theory.
This is a real-space code for periodic, semi-periodic and non-periodic pseudopotential
and all-electron calculations, and is based on adaptive finite-element discretization.
For further details, and citing, please refer to our website: https://sites.google.com/umich.edu/dftfe
==========================================================================================================
 DFT-FE Principal developers and Mentors (alphabetically) :									
														
 Sambit Das               - University of Michigan, Ann Arbor
 Vikram Gavini (Mentor)   - University of Michigan, Ann Arbor
 Krishnendu Ghosh         - University of Michigan, Ann Arbor
 Phani Motamarri          - University of Michigan, Ann Arbor
 Shiva Rudraraju          - University of Wisconsin-Madison  
 (A complete list of the many authors that have contributed to DFT-FE can be found in the authors file)
==========================================================================================================
 	     Copyright (c) 2017-2019 The Regents of the University of Michigan and DFT-FE authors         
 			DFT-FE is published under [LGPL v2.1 or newer] 				
==========================================================================================================
==========================================================================================================
set H REFINED ELECTROSTATICS = true
set P REFINED ELECTROSTATICS = false
set REPRODUCIBLE OUTPUT      = false
set VERBOSITY                = 1
subsection Boundary conditions
  set CONSTRAINTS FROM SERIAL DOFHANDLER = false
  set CONSTRAINTS PARALLEL CHECK         = false
  set PERIODIC1                          = true
  set PERIODIC2                          = true
  set PERIODIC3                          = true
  set SELF POTENTIAL RADIUS              = 0.0
end
subsection Brillouin zone k point sampling options
  set USE GROUP SYMMETRY         = false
  set USE TIME REVERSAL SYMMETRY = true
  set kPOINT RULE FILE           = 
  subsection Monkhorst-Pack (MP) grid generation
    set SAMPLING POINTS 1 = 1
    set SAMPLING POINTS 2 = 1
    set SAMPLING POINTS 3 = 1
    set SAMPLING SHIFT 1  = 0
    set SAMPLING SHIFT 2  = 0
    set SAMPLING SHIFT 3  = 0
  end
end
subsection Checkpointing and Restart
  set CHK TYPE         = 0
  set RESTART FROM CHK = false
end
subsection DFT functional parameters
  set EXCHANGE CORRELATION TYPE       = 1
  set PSEUDOPOTENTIAL CALCULATION     = true
  set PSEUDOPOTENTIAL FILE NAMES LIST = pseudo.inp
  set PSEUDO TESTS FLAG               = false
  set SPIN POLARIZATION               = 0
  set START MAGNETIZATION             = 0.0
end
subsection Finite element mesh parameters
  set MESH FILE        = 
  set POLYNOMIAL ORDER = 4
  subsection Auto mesh generation parameters
    set ATOM BALL RADIUS             = 2.0
    set AUTO USER MESH PARAMS        = true
    set BASE MESH SIZE               = 0.0
    set ERROR ESTIMATE WAVEFUNCTIONS = 5
    set INNER ATOM BALL RADIUS       = 0.0
    set MESH ADAPTION                = false
    set MESH SIZE AROUND ATOM        = 0.8
    set MESH SIZE AT ATOM            = 0.0
    set NUM LEVELS                   = 10
    set TOLERANCE FOR MESH ADAPTION  = 1
    set TOP FRAC                     = 0.1
  end
end
subsection Geometry
  set ATOMIC COORDINATES FILE = coordinates.inp
  set DOMAIN VECTORS FILE     = domainBoundingVectors.inp
  set NATOMS                  = 4
  set NATOM TYPES             = 1
  subsection Optimization
    set CELL CONSTRAINT TYPE      = 12
    set CELL OPT                  = false
    set CELL STRESS               = true
    set FORCE TOL                 = 1e-4
    set ION FORCE                 = false
    set ION OPT                   = false
    set ION RELAX FLAGS FILE      = 
    set NON SELF CONSISTENT FORCE = false
    set REUSE DENSITY             = false
    set REUSE WFC                 = false
    set STRESS TOL                = 1e-6
  end
end
subsection Parallelization
  set BAND PARAL OPT           = true
  set MPI ALLREDUCE BLOCK SIZE = 100.0
  set NPBAND                   = 1
  set NPKPT                    = 1
end
subsection Poisson problem parameters
  set MAXIMUM ITERATIONS = 10000
  set TOLERANCE          = 1e-10
end
subsection Postprocessing
  set WRITE DENSITY                 = false
  set WRITE DENSITY OF STATES       = false
  set WRITE LOCALIZATION LENGTHS    = false
  set WRITE LOCAL DENSITY OF STATES = false
  set WRITE WFC                     = false
end
subsection SCF parameters
  set COMPUTE ENERGY EACH ITER = true
  set CONSTRAINT MAGNETIZATION = false
  set HIGHER QUAD NLP          = true
  set MAXIMUM ITERATIONS       = 200
  set MIXING HISTORY           = 50
  set MIXING METHOD            = ANDERSON
  set MIXING PARAMETER         = 0.2
  set STARTING WFC             = ATOMIC
  set TEMPERATURE              = 500
  set TOLERANCE                = 5e-5
  subsection Eigen-solver parameters
    set ADAPTIVE FILTER STATES              = 0
    set ALGO                                = NORMAL
    set BATCH GEMM                          = true
    set CHEBYSHEV FILTER TOLERANCE          = 5e-02
    set CHEBYSHEV POLYNOMIAL DEGREE         = 0
    set CHEBY WFC BLOCK SIZE                = 400
    set ENABLE SUBSPACE ROT PGS OPT         = true
    set ENABLE SWITCH TO GS                 = true
    set LOWER BOUND UNWANTED FRAC UPPER     = 0
    set LOWER BOUND WANTED SPECTRUM         = -10.0
    set NUMBER OF KOHN-SHAM WAVEFUNCTIONS   = 20
    set ORTHOGONALIZATION TYPE              = Auto
    set RR GEP                              = true
    set SCALAPACKPROCS                      = 0
    set SCALAPACK BLOCK SIZE                = 50
    set SPECTRUM SPLIT CORE EIGENSTATES     = 0
    set SPECTRUM SPLIT STARTING SCF ITER    = 0
    set SUBSPACE ROT DOFS BLOCK SIZE        = 5000
    set USE ELPA                            = false
    set USE MIXED PREC PGS O                = false
    set USE MIXED PREC PGS SR               = false
    set USE MIXED PREC RR_SR SPECTRUM SPLIT = false
    set USE MIXED PREC XTHX SPECTRUM SPLIT  = false
    set WFC BLOCK SIZE                      = 400
  end
end
Setting USE BATCH GEMM=false as intel mkl blas library is not being linked to.
Setting ORTHOGONALIZATION TYPE=PGS for pseudopotential calculations 
=================================MPI Parallelization=========================================
Total number of MPI tasks: 16
k-point parallelization processor groups: 1
Band parallelization processor groups: 1
Number of MPI tasks for finite-element domain decomposition: 16
============================================================================================
number of atoms: 4
number of atoms types: 1
Z:13
reading data from file: /home/dsambit/dftfeNew/data/electronicStructure/pseudoPotential/z13/singleAtomData/psi20.inp
reading data from file: /home/dsambit/dftfeNew/data/electronicStructure/pseudoPotential/z13/singleAtomData/psi21.inp
reading data from file: /home/dsambit/dftfeNew/data/electronicStructure/pseudoPotential/z13/singleAtomData/psi30.inp
=============================================================================================================================
number of electrons: 12
number of eigen values: 20
number of wavefunctions computed using single atom data to be used as initial guess for starting the SCF: 20
=============================================================================================================================
Total number of k-points 1
-----------Reciprocal vectors along which the MP grid is to be generated-------------
G1 : 8.267349088394193579e-01 0.000000000000000000e+00 0.000000000000000000e+00
G2 : 0.000000000000000000e+00 8.267349088394193579e-01 0.000000000000000000e+00
G3 : 0.000000000000000000e+00 0.000000000000000000e+00 8.267349088394193579e-01
 number of irreducible k-points 1
Reduced k-Point-coordinates and weights: 
      1:       0.00000       0.00000      0.00000      1.00000

Reading Pseudo-potential data for each atom from the list given in : pseudo.inp
 Reading Pseudopotential File: Al_KB_LDA.upf, with atomic number: 13
Atomic system initialization, wall time: 0.490674s.
-----------Simulation Domain bounding vectors (lattice vectors in fully periodic case)-------------
v1 : 7.599999999999999645e+00 0.000000000000000000e+00 0.000000000000000000e+00
v2 : 0.000000000000000000e+00 7.599999999999999645e+00 0.000000000000000000e+00
v3 : 0.000000000000000000e+00 0.000000000000000000e+00 7.599999999999999645e+00
-----------------------------------------------------------------------------------------
-----Fractional coordinates of atoms------ 
AtomId 0:  0.000000000000000000e+00 0.000000000000000000e+00 0.000000000000000000e+00
AtomId 1:  0.000000000000000000e+00 5.000000000000000000e-01 5.000000000000000000e-01
AtomId 2:  5.000000000000000000e-01 0.000000000000000000e+00 5.000000000000000000e-01
AtomId 3:  5.000000000000000000e-01 5.000000000000000000e-01 0.000000000000000000e+00
-----------------------------------------------------------------------------------------

Finite element mesh information
-------------------------------------------------
number of elements: 288
number of degrees of freedom: 24169
Minimum mesh size: 9.499999999999981792e-01
-------------------------------------------------

-----------------------------------------------------------------------------
Rough estimate of peak memory requirement (RAM) total: 8.038670400000000882e+00 GB.
Rough estimate of peak memory requirement (RAM) per MPI task: 5.024169000000000551e-01 GB.
DFT-FE Message: many of the memory optimizations implemented
in DFT-FE are useful only for larger system sizes.
-----------------------------------------------------------------------------
DFT-FE Warning: The number of degrees of freedom per domain decomposition processor are less than 4000, where the parallel scaling efficiency is not good. We recommend to use 4000 or more degrees of freedom per domain decomposition processor. For further parallelization use input parameters NPBAND and/or NPKPT(in case of multiple k points).
Determining the ball radius around the atom for nuclear self-potential solve... 
...Adaptively set ball radius: 1.750000000000000000e+00
DFT-FE warning: Tried to adaptively determine the ball radius for nuclear self-potential solve and was found to be less than 2.5, which can detoriate the accuracy of the KSDFT groundstate energy and forces. One approach to overcome this issue is to use a larger super cell with smallest periodic dimension greater than 5.0 (twice of 2.5), assuming an orthorhombic domain. If that is not feasible, you may need more h refinement of the finite element mesh around the atoms to achieve the desired accuracy.
Volume of the domain (Bohr^3): 4.389760000000031823e+02

Setting initial guess for wavefunctions....
Number of wavefunctions generated randomly to be used as initial guess for starting the SCF : 0

Reading initial guess for electron-density.....
Initial total charge: 1.199999999999996092e+01

Pseudopotential initalization....
KSDFT problem initialization, wall time: 62.4835s.
Nuclear self-potential solve, wall time: 4.0037s.

************************Begin Self-Consistent-Field Iteration:  1 ***********************
Fermi Energy computed: -1.333078505275087366e-01
Total energy  : -8.076174281580964731e+00
***********************Self-Consistent-Field Iteration:  1 complete**********************
Wall time for the above scf iteration: 2.163617657200000011e+01 seconds
Number of Chebyshev filtered subspace iterations: 2

************************Begin Self-Consistent-Field Iteration:  2 ***********************
Simple mixing, L2 norm of electron-density difference: 1.065187126778452953e-01
Fermi Energy computed: -1.372090187696290986e-01
Total energy  : -8.141060186602608439e+00
***********************Self-Consistent-Field Iteration:  2 complete**********************
Wall time for the above scf iteration: 1.051574878599999963e+01 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  3 ***********************
L2 norm of electron-density difference: 4.848911057006743269e-02
Fermi Energy computed: -1.416613894580615041e-01
Total energy  : -8.142906171495614132e+00
***********************Self-Consistent-Field Iteration:  3 complete**********************
Wall time for the above scf iteration: 1.129463175000000064e+01 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  4 ***********************
L2 norm of electron-density difference: 2.442991362497248797e-02
Fermi Energy computed: -1.499718246874326977e-01
Total energy  : -8.142928931296522066e+00
***********************Self-Consistent-Field Iteration:  4 complete**********************
Wall time for the above scf iteration: 9.909973176999999467e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  5 ***********************
L2 norm of electron-density difference: 7.767173465847846021e-03
Fermi Energy computed: -1.481515086613880150e-01
Total energy  : -8.142930687119893207e+00
***********************Self-Consistent-Field Iteration:  5 complete**********************
Wall time for the above scf iteration: 8.589900620999999958e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  6 ***********************
L2 norm of electron-density difference: 1.707740769511508242e-03
Fermi Energy computed: -1.476628306991967787e-01
Total energy  : -8.142930782258336109e+00
***********************Self-Consistent-Field Iteration:  6 complete**********************
Wall time for the above scf iteration: 8.589488653000000085e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  7 ***********************
L2 norm of electron-density difference: 4.288119060554193562e-04
Fermi Energy computed: -1.475878907533509365e-01
Total energy  : -8.142930804525509103e+00
***********************Self-Consistent-Field Iteration:  7 complete**********************
Wall time for the above scf iteration: 8.406541750000000590e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  8 ***********************
L2 norm of electron-density difference: 5.509118631623085400e-05
Fermi Energy computed: -1.475669539242417672e-01
Total energy  : -8.142930809340885645e+00
***********************Self-Consistent-Field Iteration:  8 complete**********************
Wall time for the above scf iteration: 8.208496585000000678e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration:  9 ***********************
L2 norm of electron-density difference: 5.578460585780662512e-05
Fermi Energy computed: -1.475742907835889128e-01
Total energy  : -8.142930809487634036e+00
***********************Self-Consistent-Field Iteration:  9 complete**********************
Wall time for the above scf iteration: 8.499103095000000607e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

************************Begin Self-Consistent-Field Iteration: 10 ***********************
L2 norm of electron-density difference: 2.694179140186998643e-05
Fermi Energy computed: -1.475728358900112447e-01
Total energy  : -8.142930809575181783e+00
***********************Self-Consistent-Field Iteration: 10 complete**********************
Wall time for the above scf iteration: 8.502189389999999847e+00 seconds
Number of Chebyshev filtered subspace iterations: 1

SCF iterations converged to the specified tolerance after: 10 iterations.
 Printing KS eigen values (spin split if this is a spin polarized calculation ) and fractional occupancies for kPoint 0
  
0 : -5.018300968607810608e-01       1.000000000000000000e+00
1 : -1.973909155137186233e-01       9.999999999999782396e-01
2 : -1.973909152069280304e-01       9.999999999999782396e-01
3 : -1.973909149133074858e-01       9.999999999999782396e-01
4 : -1.486704994923864487e-01       6.666849667279513003e-01
5 : -1.486704967669735533e-01       6.666845842417367107e-01
6 : -1.486701110412532723e-01       6.666304490303769370e-01
7 : 1.159233607217211026e-01       5.353061720585510708e-73
8 : 1.159233922599971767e-01       5.352955099360545471e-73
9 : 1.159234037092114894e-01       5.352916393608603536e-73
10 : 1.159241015768608246e-01       5.350557677803587355e-73
11 : 1.159241030292506303e-01       5.350552769970052127e-73
12 : 1.159241395678970860e-01       5.350429302119251959e-73
13 : 2.397247114307483329e-01       5.922800187817278808e-107
14 : 2.397247421810341506e-01       5.922685166109225937e-107
15 : 2.397261750255621493e-01       5.917328075102405518e-107
16 : 4.208040726035728318e-01       1.277358803397267182e-156
17 : 4.208040792728156565e-01       1.277353423223463160e-156
18 : 4.208040861551035627e-01       1.277347871206723457e-156
19 : 7.209536847620946487e-01       6.048720323754125718e-239
============================================================================================================

Energy computations (Hartree)
-------------------------------------------------------------------------------
Band energy                                         :  -2.7826871614183220e+00
Exchange energy                                     :  -2.6869355608239296e+00
Correlation energy                                  :  -5.3532213499659420e-01
Total energy                                        :  -8.1429308095751818e+00
Total energy per atom                               :  -2.0357327023937954e+00
-------------------------------------------------------------------------------
Total scf solve, wall time: 105.202s.

Cell stress (Hartree/Bohr^3)
------------------------------------------------------------------------
-2.562807907001027298e-04  -1.336007692352736049e-16  -2.348243207508873033e-17
-1.418836375598457107e-16  -2.562807893408757085e-04  -2.087221325984088155e-10
3.187343903927431805e-17  -2.087221139346141092e-10  -2.562807893455140880e-04
------------------------------------------------------------------------
Cell stress computation, wall time: 2.70933s.

------------------DFT-FE ground-state solve completed---------------------------


+---------------------------------------------+------------+------------+
| Total wallclock time elapsed since start    | 1.758e+02s |            |
|                                             |            |            |
| Section                         | no. calls |  wall time | % of total |
+---------------------------------+-----------+------------+------------+
| Atomic system initialization    |         1 | 4.907e-01s |  2.79e-01% |
| Cell stress computation         |         1 | 2.709e+00s |  1.54e+00% |
| KSDFT problem initialization    |         1 | 6.248e+01s |  3.55e+01% |
| Nuclear self-potential solve    |         1 | 4.004e+00s |  2.28e+00% |
| Total scf solve                 |         1 | 1.052e+02s |  5.98e+01% |
+---------------------------------+-----------+------------+------------+

=============================================================================================
DFT-FE Program ends. Elapsed wall time since start of the program: 1.759195631379261613e+02 seconds.
=============================================================================================
